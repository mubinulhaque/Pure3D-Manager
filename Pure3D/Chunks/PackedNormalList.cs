using Godot;
using System.IO;

namespace Pure3D.Chunks
{
    [ChunkType(65552)]
    public class PackedNormalList : Chunk
    {
        double[,] normals = new double[256, 3] {
        { 0.000000,  0.000000, -1.000000},
        { 0.000000,  0.000000,  1.000000},
        { 0.000000, -1.000000,  0.000000},
        { 0.000000,  1.000000,  0.000000},
        {-1.000000,  0.000000,  0.000000},
        { 1.000000,  0.000000,  0.000000},
        { 0.894427,  0.000000,  0.447214},
        { 0.276393,  0.850651,  0.447214},
        {-0.723607,  0.525731,  0.447214},
        {-0.723607, -0.525731,  0.447214},
        { 0.276393, -0.850651,  0.447214},
        { 0.723607,  0.525731, -0.447214},
        {-0.276393,  0.850651, -0.447214},
        {-0.894427, -0.000000, -0.447214},
        {-0.276393, -0.850651, -0.447214},
        { 0.723607, -0.525731, -0.447214},
        { 0.219625,  0.000000,  0.975585},
        { 0.428525,  0.000000,  0.903530},
        { 0.616500,  0.000000,  0.787355},
        { 0.774370,  0.000000,  0.632733},
        { 0.067868,  0.208875,  0.975585},
        { 0.132421,  0.407551,  0.903530},
        { 0.190509,  0.586326,  0.787355},
        { 0.239294,  0.736470,  0.632733},
        {-0.177680,  0.129092,  0.975585},
        {-0.346684,  0.251881,  0.903530},
        {-0.498759,  0.362369,  0.787355},
        {-0.626479,  0.455163,  0.632733},
        {-0.177680, -0.129092,  0.975585},
        {-0.346684, -0.251881,  0.903530},
        {-0.498759, -0.362369,  0.787355},
        {-0.626479, -0.455163,  0.632733},
        { 0.067868, -0.208875,  0.975585},
        { 0.132422, -0.407551,  0.903530},
        { 0.190509, -0.586326,  0.787355},
        { 0.239294, -0.736470,  0.632733},
        { 0.842238,  0.208875,  0.496997},
        { 0.748921,  0.407551,  0.522512},
        { 0.619034,  0.586326,  0.522512},
        { 0.458918,  0.736470,  0.496997},
        { 0.061613,  0.865562,  0.496997},
        {-0.156175,  0.838207,  0.522512},
        {-0.366337,  0.769921,  0.522512},
        {-0.558611,  0.664039,  0.496997},
        {-0.804159,  0.326071,  0.496997},
        {-0.845443,  0.110489,  0.522512},
        {-0.845443, -0.110489,  0.522512},
        {-0.804159, -0.326071,  0.496997},
        {-0.558611, -0.664039,  0.496997},
        {-0.366337, -0.769921,  0.522512},
        {-0.156175, -0.838207,  0.522512},
        { 0.061614, -0.865562,  0.496997},
        { 0.458918, -0.736470,  0.496997},
        { 0.619034, -0.586326,  0.522512},
        { 0.748921, -0.407551,  0.522512},
        { 0.842238, -0.208875,  0.496997},
        { 0.952050,  0.129092,  0.277373},
        { 0.963184,  0.251881,  0.093987},
        { 0.927284,  0.362369, -0.093987},
        { 0.846103,  0.455163, -0.277373},
        { 0.171426,  0.945345,  0.277373},
        { 0.058087,  0.993877,  0.093987},
        {-0.058087,  0.993877, -0.093987},
        {-0.171426,  0.945345, -0.277373},
        {-0.846103,  0.455163,  0.277373},
        {-0.927284,  0.362369,  0.093987},
        {-0.963184,  0.251880, -0.093987},
        {-0.952050,  0.129092, -0.277373},
        {-0.694346, -0.664039,  0.277373},
        {-0.631180, -0.769921,  0.093987},
        {-0.537193, -0.838207, -0.093987},
        {-0.416973, -0.865562, -0.277373},
        { 0.416974, -0.865562,  0.277373},
        { 0.537193, -0.838207,  0.093987},
        { 0.631180, -0.769921, -0.093987},
        { 0.694346, -0.664039, -0.277373},
        { 0.952050, -0.129092,  0.277373},
        { 0.963184, -0.251881,  0.093987},
        { 0.927284, -0.362369, -0.093987},
        { 0.846103, -0.455163, -0.277373},
        { 0.416974,  0.865562,  0.277373},
        { 0.537193,  0.838207,  0.093987},
        { 0.631180,  0.769921, -0.093987},
        { 0.694346,  0.664039, -0.277373},
        {-0.694346,  0.664039,  0.277373},
        {-0.631180,  0.769921,  0.093987},
        {-0.537193,  0.838207, -0.093987},
        {-0.416974,  0.865562, -0.277373},
        {-0.846103, -0.455163,  0.277373},
        {-0.927284, -0.362370,  0.093987},
        {-0.963184, -0.251881, -0.093987},
        {-0.952050, -0.129092, -0.277373},
        { 0.171426, -0.945345,  0.277373},
        { 0.058088, -0.993877,  0.093987},
        {-0.058087, -0.993877, -0.093987},
        {-0.171426, -0.945345, -0.277373},
        { 0.558611,  0.664039, -0.496997},
        { 0.366337,  0.769921, -0.522512},
        { 0.156175,  0.838207, -0.522512},
        {-0.061613,  0.865562, -0.496997},
        {-0.458918,  0.736470, -0.496997},
        {-0.619034,  0.586326, -0.522512},
        {-0.748921,  0.407551, -0.522512},
        {-0.842238,  0.208875, -0.496997},
        {-0.842238, -0.208876, -0.496997},
        {-0.748921, -0.407551, -0.522512},
        {-0.619034, -0.586326, -0.522512},
        {-0.458918, -0.736470, -0.496997},
        {-0.061613, -0.865562, -0.496997},
        { 0.156175, -0.838207, -0.522512},
        { 0.366337, -0.769921, -0.522512},
        { 0.558611, -0.664039, -0.496997},
        { 0.804159, -0.326071, -0.496997},
        { 0.845443, -0.110489, -0.522512},
        { 0.845443,  0.110489, -0.522512},
        { 0.804159,  0.326071, -0.496997},
        { 0.177680,  0.129092, -0.975585},
        { 0.346684,  0.251881, -0.903530},
        { 0.498759,  0.362369, -0.787355},
        { 0.626479,  0.455163, -0.632733},
        {-0.067868,  0.208875, -0.975585},
        {-0.132421,  0.407551, -0.903530},
        {-0.190509,  0.586326, -0.787355},
        {-0.239294,  0.736470, -0.632733},
        {-0.219625, -0.000000, -0.975585},
        {-0.428525, -0.000000, -0.903530},
        {-0.616500, -0.000000, -0.787355},
        {-0.774370, -0.000000, -0.632733},
        {-0.067868, -0.208876, -0.975585},
        {-0.132421, -0.407551, -0.903530},
        {-0.190509, -0.586326, -0.787355},
        {-0.239293, -0.736470, -0.632733},
        { 0.177680, -0.129092, -0.975585},
        { 0.346684, -0.251881, -0.903530},
        { 0.498759, -0.362369, -0.787355},
        { 0.626479, -0.455163, -0.632733},
        { 0.289817,  0.210565,  0.933632},
        { 0.502093,  0.212399,  0.838326},
        { 0.357158,  0.411884,  0.838326},
        { 0.690990,  0.212688,  0.690867},
        { 0.569213,  0.413557,  0.710610},
        { 0.415806,  0.591446,  0.690867},
        {-0.110700,  0.340701,  0.933632},
        {-0.046848,  0.543153,  0.838326},
        {-0.281357,  0.466957,  0.838326},
        { 0.011249,  0.722895,  0.690867},
        {-0.217420,  0.669150,  0.710610},
        {-0.434008,  0.578222,  0.690867},
        {-0.358234, -0.000000,  0.933632},
        {-0.531046,  0.123288,  0.838326},
        {-0.531046, -0.123289,  0.838326},
        {-0.684038,  0.234085,  0.690867},
        {-0.703586, -0.000000,  0.710610},
        {-0.684038, -0.234086,  0.690867},
        {-0.110700, -0.340701,  0.933632},
        {-0.281357, -0.466957,  0.838326},
        {-0.046848, -0.543153,  0.838326},
        {-0.434008, -0.578222,  0.690867},
        {-0.217420, -0.669150,  0.710610},
        { 0.011249, -0.722895,  0.690867},
        { 0.289817, -0.210565,  0.933632},
        { 0.357159, -0.411884,  0.838326},
        { 0.502093, -0.212399,  0.838326},
        { 0.415806, -0.591446,  0.690867},
        { 0.569213, -0.413557,  0.710610},
        { 0.690990, -0.212688,  0.690867},
        { 0.995273,  0.000000,  0.097119},
        { 0.987312, -0.123288, -0.100072},
        { 0.987312,  0.123289, -0.100072},
        { 0.923841, -0.234085, -0.302857},
        { 0.950242,  0.000000, -0.311512},
        { 0.923841,  0.234086, -0.302857},
        { 0.307556,  0.946561,  0.097119},
        { 0.422351,  0.900892, -0.100072},
        { 0.187842,  0.977088, -0.100072},
        { 0.508111,  0.806288, -0.302857},
        { 0.293641,  0.903734, -0.311512},
        { 0.062854,  0.950961, -0.302857},
        {-0.805193,  0.585007,  0.097119},
        {-0.726285,  0.680070, -0.100072},
        {-0.871220,  0.480585, -0.100072},
        {-0.609811,  0.732399, -0.302857},
        {-0.768762,  0.558538, -0.311512},
        {-0.884995,  0.353641, -0.302857},
        {-0.805192, -0.585007,  0.097119},
        {-0.871220, -0.480585, -0.100072},
        {-0.726285, -0.680070, -0.100072},
        {-0.884995, -0.353641, -0.302857},
        {-0.768762, -0.558538, -0.311512},
        {-0.609811, -0.732399, -0.302857},
        { 0.307556, -0.946561,  0.097119},
        { 0.187842, -0.977088, -0.100072},
        { 0.422351, -0.900892, -0.100072},
        { 0.062854, -0.950961, -0.302857},
        { 0.293641, -0.903734, -0.311512},
        { 0.508111, -0.806288, -0.302857},
        { 0.805193,  0.585007, -0.097119},
        { 0.726285,  0.680070,  0.100072},
        { 0.871220,  0.480585,  0.100072},
        { 0.609811,  0.732399,  0.302857},
        { 0.768762,  0.558538,  0.311512},
        { 0.884995,  0.353641,  0.302857},
        {-0.307556,  0.946561, -0.097119},
        {-0.422351,  0.900892,  0.100072},
        {-0.187842,  0.977088,  0.100072},
        {-0.508111,  0.806288,  0.302857},
        {-0.293641,  0.903734,  0.311512},
        {-0.062854,  0.950961,  0.302857},
        {-0.995273, -0.000000, -0.097119},
        {-0.987312, -0.123289,  0.100072},
        {-0.987312,  0.123288,  0.100072},
        {-0.923841, -0.234086,  0.302857},
        {-0.950242, -0.000000,  0.311512},
        {-0.923841,  0.234085,  0.302857},
        {-0.307556, -0.946561, -0.097119},
        {-0.187842, -0.977088,  0.100072},
        {-0.422350, -0.900892,  0.100072},
        {-0.062854, -0.950961,  0.302857},
        {-0.293641, -0.903734,  0.311512},
        {-0.508111, -0.806288,  0.302857},
        { 0.805193, -0.585007, -0.097119},
        { 0.871220, -0.480585,  0.100072},
        { 0.726285, -0.680070,  0.100072},
        { 0.884995, -0.353641,  0.302857},
        { 0.768762, -0.558538,  0.311512},
        { 0.609811, -0.732399,  0.302857},
        { 0.110700,  0.340701, -0.933632},
        { 0.046848,  0.543153, -0.838326},
        { 0.281357,  0.466957, -0.838326},
        {-0.011249,  0.722895, -0.690867},
        { 0.217420,  0.669150, -0.710610},
        { 0.434008,  0.578222, -0.690867},
        {-0.289817,  0.210565, -0.933632},
        {-0.502093,  0.212399, -0.838326},
        {-0.357158,  0.411884, -0.838326},
        {-0.690990,  0.212688, -0.690867},
        {-0.569213,  0.413557, -0.710610},
        {-0.415806,  0.591446, -0.690867},
        {-0.289817, -0.210565, -0.933632},
        {-0.357158, -0.411884, -0.838326},
        {-0.502093, -0.212399, -0.838326},
        {-0.415806, -0.591446, -0.690867},
        {-0.569213, -0.413558, -0.710610},
        {-0.690990, -0.212688, -0.690867},
        { 0.110700, -0.340701, -0.933632},
        { 0.281357, -0.466957, -0.838326},
        { 0.046848, -0.543153, -0.838326},
        { 0.434008, -0.578222, -0.690867},
        { 0.217420, -0.669150, -0.710610},
        {-0.011249, -0.722895, -0.690867},
        { 0.358234,  0.000000, -0.933632},
        { 0.531046,  0.123289, -0.838326},
        { 0.531046, -0.123288, -0.838326},
        { 0.684038,  0.234086, -0.690867},
        { 0.703586,  0.000000, -0.710610},
        { 0.684038, -0.234085, -0.690867},
        };

        public Vector3[] Normals;

        public PackedNormalList(File file, uint type) : base(file, type)
        {
        }

        public override void ReadHeader(Stream stream, long length)
        {
            BinaryReader reader = new(stream);
            uint len = reader.ReadUInt32();
            Normals = new Vector3[len];
            for (int i = 0; i < len; i++)
            {
                uint index = reader.ReadByte();
                Normals[i] = new Vector3(
                    (float)normals[index, 0],
                    (float)normals[index, 1],
                    (float)normals[index, 2]
                );
            }
        }

        public override string ToString()
        {
            return $"Packed Normal List ({Normals.Length} Normals)";
        }

        public override string ToShortString()
        {
            return $"{Normals.Length} Packed Normals";
        }
    }
}
